
import os

from fabdeploy.api import DefaultConf


DIRNAME = os.path.dirname(__file__)



class BaseConf(DefaultConf):
    """Base deployment settings."""

    django_dir = 'api'
    home_path = '/webapps/cloudmlui'

    ui_scripts_dir = ['%(current_project_link)s', 'ui', 'app', 'scripts']
    current_public_link = ['%(current_project_link)s', 'ui', '_public']
    current_docs_link = ['%(current_project_link)s', 'docs', 'build', 'html']

    pip_req_path = ''
    pip_req_name = 'requirements.txt'

    supervisor_prefix = 'cloudmlui_'
    supervisord_config_lfile = 'supervisor/supervisord.conf'
    supervisord_config_file = ['%(supervisor_config_path)s', 'supervisord.conf']
    
    local_anjsettings_file = ['%(ui_scripts_dir)s', 'local_config.coffee']

    supervisor__log_path = ['%(var_path)s', 'log', 'supervisor']
    supervisor_programs = ['celeryd', 'celerycam', 'gunicorn']

    rabbitmq_host = 'localhost'
    rabbitmq_port = 5672
    rabbitmq_user = '%(user)s'
    rabbitmq_password = '%(user)s'
    rabbitmq_vhost =  '%(user)s'

    broker_backend = 'amqplib'
    broker_host = 'localhost'
    broker_port = '%(rabbitmq_port)s'
    broker_user = '%(rabbitmq_user)s'
    broker_password = '%(rabbitmq_password)s'
    broker_vhost = '%(rabbitmq_vhost)s'

    db_name = 'cloudml'

    # Local settings file
    local_settings_file = 'config.py'


class DevConf(BaseConf):
    """Settings specific to dev environment."""

    address = 'cloudml@172.27.68.147'

    sudo_user = 'nmelnik'
    home_path = '/webapps/cloudml'

    # Code from this branch will be deployed.
    branch = 'master'

    server_name = '172.27.68.147'
    # For Apache ServerAdmin directive
    server_admin = 'ifoukarakis@odesk.com'
    # Apache will serve WSGI on this port. (Nginx is front-end.)
    apache_port = 80

    remote_settings_lfile = 'prod_config.py.tpl'


class StagingConf(BaseConf):
    """Settings specific to production environment."""

    address = 'cloudml@172.27.77.182'

    home_path = '/webapps/cloudml'

    sudo_user = 'moorcock'

    # Code from this branch will be deployed.
    repo_branch = 'staging'
    queue = 'Main,default'

    server_name = '172.27.77.182'
    # For Nginx ServerAdmin directive
    server_admin = 'moorcock@odesk.com'
    # Gunicorn will serve WSGI on this port. (Nginx is front-end.)
    gunicorn_port = 5000

    remote_settings_lfile = 'staging_config.py.tpl'
    remote_anjsettings_lfile = 'ui/app/scripts/staging_config.coffee.tpl'

    amazon_access_token = 'AKIAJYNNIPFWF2ABW42Q'
    amazon_token_secret = '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'
    amazon_bucket_name = 'odesk-match-cloudml'

    odesk_api_key = '6b1d852a66a6468efaa329510cab0748'
    odesk_secret_key = '7a92ec3683f3cf4b'

    local_settings_file = 'local_config.py'



class ProductionConf(BaseConf):
    """Settings specific to production environment."""

    address = 'cloudml@172.27.77.141'

    home_path = '/webapps/cloudmlui'

    sudo_user = 'nmelnik'

    # Code from this branch will be deployed.
    branch = 'master'

    server_name = 'cloudml.match.odesk.com'
    # For Nginx ServerAdmin directive
    server_admin = 'nmelnik@odesk.com'
    # Gunicorn will serve WSGI on this port. (Nginx is front-end.)
    gunicorn_port = 5000

    remote_settings_lfile = 'prod_config.py.tpl'
    remote_anjsettings_lfile = 'ui/app/scripts/prod_config.coffee.tpl'

    amazon_access_token = '....'
    amazon_token_secret = '....'
    amazon_bucket_name = 'odesk-match-cloudml'
