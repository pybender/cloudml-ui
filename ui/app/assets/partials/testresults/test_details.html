<h2>{{ test.name|capfirst }} Details</h2>

<div ng-hide="test.loaded">Loading...</div>

<alert-message ng-show="test.loaded && test.status != 'Completed'" class="alert-warning" msg="Test was not calculated yet. Status: {{ test.status }}" unsafe></alert-message>

<alert-message ng-show="test.error" class="alert-error" msg="{{ test.error }}" unsafe></alert-message>

<div ng-show="test.loaded && showLog">
    <h4>Log Messages:</h4>
    <div class="logging">
      <div ng-repeat="msg in log_messages">{{ msg }}</div>
    </div>
</div>

<div ng-show="test.status == 'Completed'">
  <ul class="nav nav-tabs" id="tabs">
    <li ng-class="{active: action[0] == 'metrics'}"><a ng-click="setSection(['metrics', 'accuracy'])">Metrics</a></li>
    <li ng-class="{active: action[0] == 'matrix'}"><a ng-click="setSection(['matrix', 'confusion'])">Confusion Matrix</a></li>
    <li ng-show="test.status == 'Completed'" ng-class="{active: action[0] == 'examples'}"><a ng-click="setSection(['examples', 'list'])">Examples</a></li>
    <li ng-class="{active: action[0] == 'about'}"><a ng-click="setSection(['about', 'details'])">About</a></li>
  </ul>

    <div class="tab-content">
      <div ng-show="action[0] == 'about'">
        <div class="row">
            <div class="span6">
                <div>
                    Import parameters:
                    <span class="value">{{ test.parameters }}</span>
                </div>
                <div>
                    Classes Set:
                    <span class="value">
                        <span ng-repeat='cls in test.classes_set'><span class="label">{{ cls }}</span> </span> 
                    </span>
                </div>
                <div>
                    Created at: <span class="value">{{ test.created_on|format_date }}</span>
                </div>
                <div>
                    Examples count: <span class="value">{{ test.examples_count }}</span>
                </div>
            </div>
        </div>
      </div>

      <div ng-show="action[0] == 'metrics'">
        <div class="actions"><a ng-show="test.status == 'Completed'" class="btn" href="#{{ test.avaragePrecisionUrl() }}"><i class="status-icon icon-search"></i> Average precision</a></div>
        <p class="switcher">
          <b>Switch View: </b>
          <a ng-class="{active: action[1] == 'accuracy'}" ng-click="setSection(['metrics', 'accuracy'])">Accuracy</a> | 
          <a ng-class="{active: action[1] == 'roc_curve'}" ng-click="setSection(['metrics', 'roc_curve'])">ROC curve</a> | 
          <a ng-class="{active: action[1] == 'precision_recal'}" ng-click="setSection(['metrics', 'precision_recal'])">Precision recall</a>
        </p>
        <div ng-show="action[1] == 'accuracy'">
          <div>
              Classification Accuracy: <span class="value">{{ test.accuracy.toFixed(4) }}</span>
          </div>
        </div>
        <div ng-show="action[1] == 'roc_curve'">
          <h4>Receiver operating characteristic</h4>
          <p>The Area Under an ROC Curve: 
              <span>{{ test.metrics.roc_auc.toFixed(4) }}</span>
          </p>
          <sc-curves xlabel="False-positive rate" ylabel="True-positive rate" curves-dict="rocCurve" show-line="1" width="500"></sc-curves>
        </div>
        <div ng-show="action[1] == 'precision_recal'">
          <h4>Precision-Recall</h4>
          <sc-curves xlabel="Recall" ylabel="Precision" curves-dict="prCurve" width="500"></sc-curves>
        </div>
      </div>

      <div ng-show="action[0] == 'examples'" ng-controller="TestExamplesCtrl" ng-init="init(test)">
        <ng-include src="'/partials/examples/example_list.html'"></ng-include>
      </div>

      <div ng-show="action[0] == 'matrix'">
        <div class="row">
            <div class="span6">
                <h4>Confusion Matrix</h4>
                <confusion-matrix matrix=test.metrics.confusion_matrix url=test.examplesUrl()></confusion-matrix>
            </div>
        </div>
      </div>

    </div>
</div>